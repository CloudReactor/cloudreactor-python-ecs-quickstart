cloudreactor:
  run_environment: "simon-staging-us-east-1"

default_env_task_config:
  command: "python src/task_1.py"
  ecs:
    platform_version: "1.4.0"
    extra_main_container_properties:
      secrets:
        - name: PROC_WRAPPER_API_KEY
          valueFrom: "arn:aws:secretsmanager:{{ aws_region }}:{{ aws.account_id }}:secret:CloudReactor/{{env}}/common/cloudreactor_api_key"
  wrapper:
      process_max_retries: 0
      api_heartbeat_interval_seconds: 120
      enable_status_update_listener: true
      status_update_interval_seconds: 60
  env:
    DEPLOYMENT: "{{env}}"

task_name_to_env_config:
  fail:
    env:
      ROW_TO_FAIL_AT: 2
  timeout:
    env:
      NUM_ROWS: 300
    wrapper:
      process_timeout_seconds: 10
  secret_access:
    command: "python src/secret_access.py"
    ecs:
      task:
        role_arn: "arn:aws:iam::{{ aws.account_id }}:role/app-task-role-{{env}}"
    env:
      SECRET_VALUE_FOR_PROC_WRAPPER_TO_RESOLVE: "arn:aws:secretsmanager:{{ aws_region }}:{{ aws.account_id }}:secret:app/{{env}}/source_db|JP:$.dbname"
